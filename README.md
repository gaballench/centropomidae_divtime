# centropomidae_divtime

Code and data for the phylogenetic analysis and divergence time estimation in Biogeographic history and divergence events of the Snooks and Barracudas (Carangiformes): Evolution and Divergence spanning the closure of the Panama Isthmus (Ossa, Ballen, Acero-P, & Tavera, 2024).

This repository has the following structure:

```
├── divtime
│   ├── clock_modsel
│   │   ├── gbm
│   │   │   ├── 1..64
│   │   └── iln
│   │       ├── 1..64
│   ├── mcmctree1_GBM
│   ├── mcmctree1_ILN
│   ├── mcmctree2_GBM
│   ├── mcmctree2_ILN
│   ├── mcmctree3_GBM
│   ├── mcmctree3_ILN
│   ├── mcmctree4_GBM
│   ├── mcmctree4_ILN
│   └── phylips
├── mrbayes
├── sequences
├── strat_intervals
```

## `sequences`

This directory stores the DNA sequences in fasta format used in this study, along with the substitution model selected for each locus. Concatenated versions in both fasta and nexus formats are available along with a file identifying the partition positions in the concatenated dataset.

## `mrbayes`

Here we will find the MrBayes script (`concatenated.mb`) and the output of four independet runs as well as the summarised files.

## `strat_intervals`

The posterior of the origination time for each of the groups used is found here. The files in tsv format include the fossil occurrences. The script `strat_interval_posteriors.R` will call the code provided in Wang et al. (2016) for the calculations of the posterior density and then return and plot the posterior along with the fossil occurrences used in Figure 1.

The posteriors on the origination time for each group are then used as calibrations on their respective nodes using the truncated Cauchy distribution.

## `divtime`

The maximum credibility tree found in the previous step was used for clock model selection and divergence time estimation using MCMCtree. 

### `phylips`

Data in phylip format. Necessary for MCMCtree.

### `clock_modsel`

The file in.BV is the approximation of the multilocus dataset using the gradient and Hessian matrix for use in the approximate likelihood calculations, as generated by MCMCtree.

The stepping stones method used for clock model selection will be found here, under `iln` for the independent lognormal clock, and under `gbm` for the geometric Brownian motion model (also known as autocorrelated model). Each of these directories will have three important scripts: `step_stones.R`, `mcmctree.ctl`, and `run_stepstones.sh`. The first one will used the second one in order to generate each of the 64 stones, whereas the third one will iterate over each of the stone directories and submit them.

After finishing the stone runs, the script `../summarise_models.R` was used in order to calculate the marginal likelihood for each model and carry out model selection.

Four independent analyses using either the iln or gbm models were carried out (mcmctreeN_MOD where N is the run number 1--4 and MOD is the model, ILN for independent lognormal and GBM for the autocorrelated clock). However, only those of the best model are presented and discussed in the article.

# Reference

Ossa-Hernández N.+, Ballen G.A.+, Acero-P A., & Tavera, J.* 2024. Biogeographic history and divergence events of the Snooks and Barracudas (Carangiformes): Evolution and Divergence spanning the closure of the Panama Isthmus. BioRxiv. DOI: XXXXXXXXX

+: Shared first authorship
*: Corresponding author
